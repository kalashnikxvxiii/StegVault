# Vulnerability Disclosure

How to report security vulnerabilities in StegVault.

## Reporting a Vulnerability

### For Sensitive Issues

If you discover a **serious security vulnerability** that could put users at risk, please report it privately:

**Preferred Method**: GitHub Security Advisories
1. Go to https://github.com/kalashnikxvxiii/StegVault/security/advisories
2. Click "Report a vulnerability"
3. Fill out the form with details
4. Submit privately

### For Non-Critical Issues

For security improvements or non-critical issues:

1. Open a GitHub issue
2. Use "Security:" prefix in title
3. Label as "security"

## What to Include

When reporting a vulnerability, include:

### Required Information

- **Description**: Clear explanation of the vulnerability
- **Impact**: What can an attacker do?
- **Steps to Reproduce**: How to trigger the vulnerability
- **Affected Versions**: Which versions are vulnerable?

### Optional Information

- **Proof of Concept**: Code or commands demonstrating the issue
- **Suggested Fix**: If you have ideas for mitigation
- **CVE Request**: If you believe this deserves a CVE identifier

### Example Report

```
Title: Weak RNG Allows Nonce Prediction

Description:
The nonce generation in crypto/core.py uses a predictable PRNG
instead of cryptographically secure random bytes.

Impact:
An attacker can predict nonces, potentially enabling chosen-plaintext
attacks against XChaCha20-Poly1305 encryption.

Steps to Reproduce:
1. Create two backups in quick succession
2. Extract nonces from both backups
3. Observe nonces are sequential

Affected Versions:
- v0.6.1
- v0.1.1

Suggested Fix:
Replace `random.randbytes()` with `nacl.utils.random()`

PoC Code:
[Include code snippet]
```

## Response Timeline

### Acknowledgment

- **Within 48 hours**: We'll acknowledge receipt of your report
- **Within 7 days**: Initial assessment of severity

### Investigation

- **Within 14 days**: Detailed investigation and impact analysis
- **Within 30 days**: Patch development (for confirmed vulnerabilities)

### Disclosure

- **After patch release**: Public disclosure
- **Coordinated**: We'll work with you on disclosure timing

## Severity Classification

### Critical

**Examples**:
- Remote code execution
- Passphrase disclosure
- Private key exposure

**Response**: Immediate hotfix, emergency release

### High

**Examples**:
- Weak cryptography allowing practical attacks
- Authentication bypass
- Data corruption

**Response**: Priority fix, release within 2 weeks

### Medium

**Examples**:
- Information leakage (non-critical)
- Denial of service (local only)
- Side-channel vulnerabilities

**Response**: Standard fix, next release cycle

### Low

**Examples**:
- Documentation errors about security
- Minor information disclosure
- Theoretical attacks requiring impractical resources

**Response**: Fix in upcoming releases

## Bug Bounty

### Current Status

**v0.6.1**: No formal bug bounty program

**Future Plans**: May establish bounty program as project matures

### Recognition

While we don't offer monetary rewards currently, we:
- Credit reporters in SECURITY.md
- Mention in release notes
- Public thank you (if you wish)

## What NOT to Report

### Out of Scope

These are known limitations, not vulnerabilities:

- LSB steganography is detectable (by design)
- XChaCha20 not post-quantum secure (known limitation)
- Keyloggers can capture passphrases (out of scope)
- Weak user passphrases (user responsibility)

See [Known Limitations](Known-Limitations.md) for complete list.

### Not Security Issues

- Feature requests
- Performance issues
- UI/UX problems
- Documentation typos

Use regular GitHub issues for these.

## Responsible Disclosure

### Our Commitment

We commit to:
- **Respond promptly** to vulnerability reports
- **Keep you informed** of our progress
- **Credit you** (if you wish) in security advisories
- **Fix issues** in a reasonable timeframe
- **Coordinate disclosure** with you

### Your Responsibility

We ask that you:
- **Report privately** first (don't publish immediately)
- **Allow time** for us to develop and release a patch
- **Don't exploit** the vulnerability against real users
- **Coordinate disclosure** timing with us

## Legal Safe Harbor

### Good Faith Security Research

We support good-faith security research. If you:
- Report vulnerabilities responsibly (privately first)
- Don't access user data without permission
- Don't cause harm to the project or users
- Follow this disclosure policy

We will NOT pursue legal action and will work with you to address the issue.

### Out of Bounds

Do NOT:
- Access or modify other users' data
- Perform DoS attacks on infrastructure
- Spam or harass maintainers
- Publicly disclose before coordinated release

## Encryption Key

### PGP Key (If Available)

For encrypted communication:

```
# Currently: No PGP key set up
# Future: PGP key will be published here
```

## Past Vulnerabilities

### Security Advisories

View past security advisories:
https://github.com/kalashnikxvxiii/StegVault/security/advisories

### CVE List

**v0.6.1**: No CVEs issued yet

## Security Contact

### Primary Contact

- **GitHub Security Advisories**: (preferred method)
- **GitHub Issues**: For non-sensitive security improvements

### Response Time

- **Weekdays**: Typically within 24 hours
- **Weekends**: Within 48 hours
- **Holidays**: May take longer

## Examples of Valid Reports

### Example 1: Cryptographic Flaw

```
Title: Nonce Reuse Vulnerability

A bug in the backup workflow can cause nonce reuse if two backups
are created within the same millisecond. This breaks XChaCha20
security.

Impact: Critical (encryption broken)
Affected: v0.6.1
```

**Response**: Immediate hotfix

---

### Example 2: Side-Channel Attack

```
Title: Timing Attack on Passphrase Verification

The passphrase verification uses non-constant-time string comparison,
allowing timing attacks to extract passphrase information.

Impact: Medium (requires many attempts)
Affected: All versions
```

**Response**: Fix in next release

---

### Example 3: Dependency Vulnerability

```
Title: Pillow CVE-2024-XXXX Affects StegVault

StegVault depends on Pillow 10.0.0, which has a known vulnerability
(CVE-2024-XXXX) allowing arbitrary code execution via malicious images.

Impact: High
Affected: v0.6.1
```

**Response**: Update dependency, release patch

## Recognition

### Hall of Fame

Security researchers who responsibly disclosed vulnerabilities:

*No vulnerabilities reported yet*

## Questions

### "Can I test against the production service?"

StegVault is a local tool with no production service. You can:
- Test against your own local installation
- Use the example images in the repository
- Create test backups for analysis

### "Can I publish my findings?"

Please coordinate with us first:
1. Report vulnerability privately
2. Allow us to develop a patch
3. We'll coordinate disclosure timing with you
4. Publish after patch is released

### "What if I found the issue in a dependency?"

1. Report to the dependency's maintainers first
2. Also inform us so we can track the issue
3. We'll update dependencies when fixes are available

## Resources

- [Security Model](Security-Model.md)
- [Threat Model](Threat-Model.md)
- [Known Limitations](Known-Limitations.md)
- [GitHub Security Advisories](https://github.com/kalashnikxvxiii/StegVault/security/advisories)

## Updates

This policy may be updated. Check back regularly for changes.

**Last Updated**: 2025-12-02 (v0.6.1)
